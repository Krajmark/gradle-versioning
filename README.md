# gradle-versioning
A Gradle plugin for applying project version from Git tags.

[![Build Status](https://travis-ci.com/Widen/gradle-versioning.svg?token=UKs7oqY6xCy4WamxJFLH&branch=master)](https://travis-ci.com/Widen/gradle-versioning)

This plugin moves your project version out of the `build.gradle` file, and instead uses Git tags as the canonical source of truth for version numbers.

## Usage
Add the private repository to the list of plugin repositories in `settings.gradle`:

```
pluginManagement {
    repositories {
        maven {
            credentials {
                username System.env.JFROG_USER ?: USER
                password System.env.JFROG_PASS ?: PASSWORD
            }
            url 'https://widen.jfrog.io/widen/repo/'
        }
        gradlePluginPortal()
    }
}
```

Then apply the plugin using the standard `plugins` configuration:

```
plugins {
    id 'com.widen.versioning' version '<current version>'
}
```

Once the plugin is applied, your project will now infer the current project version automatically based on the most recent release in your Git repository. Be sure to remove any `version '<version>'` lines in your `build.gradle`, or the version number will get overwritten.

### Automatic publishing
If you are using Travis, the following configuration works quite nicely:

```yml
after_success:
  - test "$TRAVIS_PULL_REQUEST" = false && ./gradlew publish
```

## Semantic versioning
Version numbers generated by this plugin _do_ follow the [Semantic Versioning 2.0.0 spec](https://semver.org/spec/v2.0.0.html), but with a caveat. SemVer does not have the concept of post-release versions or semantically meaningful build numbers, so we put the current build number into the _version build metadata_ (everything following the `+`). This works, but most SemVer parsers ignore this part of the version in comparisons (as the spec says it _SHOULD_ be ignored), so be careful if you are doing any parsing on the version number yourself.

## Releasing this plugin
This Gradle plugin uses the most recent version of itself to determine its next version, so preparing a new release of `gradle-versioning` is much like releasing a normal project using this plugin. Simply publish a new tag in the Git repository, and a build will be published to the Maven repository automatically.
